<!DOCTYPE html>
<html>
<head>
    <title>Simulating 3D Solar System</title>
    <style>
        #canvas_3d {
            /* width: 800px;
            height: 600px; */
            position: relative;
            /* top:-140px; */
        }
        /* #canvas_top {
            /* width: 600px;
            height: 600px; */
            /* position:relative;
            left:-159px; */

        /* }  */
        #canvas_left {
            /* width: 600px;
            height: 600px; */
            position: relative;
            left:-40px;
        }
        ul{
            display: flex;
            list-style: none;
            /* margin: 0px; */
        }
        #change{
            height:200px;
            background-color: blue;
            position: relative;
            top:-700px;
        }
        
    </style>
</head>
<body>
    <ul>
        <li><div id="canvas_left"></div></li>
        <li><div id="canvas_top"></div></li>
    </ul>
    <!-- <div id="canvas_top"></div>
    <div id="canvas_left"></div>  -->
    <div id="canvas_3d">
        <button id="change">切换</button>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/110/three.min.js"></script>
    <script>
        var change=0; //初始地球图片
        window.onload = function() {
            // 创建场景
            var scene = new THREE.Scene();
            var sunPictureUrl="http://192.168.1.8:8080/web/Web-Work/sun.png";
            var earthPictureUrl="http://192.168.1.8:8080/web/Web-Work/earth.png";
            var moonPictureUrl="http://192.168.1.8:8080/web/Web-Work/moon.png";
            var new_earthPictureUrl="http://192.168.1.8:8080/web/Web-Work/new_earth.png";


            var textureLoader=new THREE.TextureLoader();
            var sunPicture=textureLoader.load(sunPictureUrl);
            var earthPicture=textureLoader.load(earthPictureUrl);
            var moonPicture=textureLoader.load(moonPictureUrl);
            var new_earthPicture=textureLoader.load(new_earthPictureUrl);

            document.getElementById("change").addEventListener('click',function(){
                if(change==0){
                    earthMaterial.map=new_earthPicture;
                    change=1;
                }
                else{
                    earthMaterial.map=earthPicture;
                    change=0;
                }
            });

        //-------------------------3种视图的相机角度---------------------------------
            // Side view camera
            var cameraSide = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            cameraSide.position.set(0, 0, 30);
            cameraSide.lookAt(new THREE.Vector3(0, 0, 0));
            scene.add(cameraSide);
            // Top view camera
            var cameraTop = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            cameraTop.position.set(0,90, 0);
            cameraTop.lookAt(new THREE.Vector3(0, 0, 0));
            scene.add(cameraTop);
            // 3D view camera
            var camera3D = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera3D.position.set(30,30,30);
            camera3D.lookAt(new THREE.Vector3(0, 0, 0));
            scene.add(camera3D);
        //------------------------------------------------------------------------

            // 创建渲染器
            var renderer3D = new THREE.WebGLRenderer({ antialias: true });
            renderer3D.setSize(window.innerWidth/1.1, window.innerHeight/1.1);

            var rendererSide = new THREE.WebGLRenderer({ antialias: true });
            rendererSide.setSize(window.innerWidth/2.2, window.innerHeight/2.2);

            var rendererTop = new THREE.WebGLRenderer({ antialias: true });
            rendererTop.setSize(window.innerWidth/2.2, window.innerHeight/2.2);
            // 将渲染器添加到HTML文档中的canvas元素中
            document.getElementById("canvas_3d").appendChild(renderer3D.domElement);
            document.getElementById("canvas_left").appendChild(rendererSide.domElement);
            document.getElementById("canvas_top").appendChild(rendererTop.domElement);
            // document.getElementById("canvas_left").appendChild(renderer.domElement);
            // 创建太阳的几何体
            var sunGeometry = new THREE.SphereGeometry(10, 32, 32);
            // 创建太阳的材质
            var sunMaterial = new THREE.MeshBasicMaterial({ map: sunPicture});
            // 创建太阳的网格
            var sun = new THREE.Mesh(sunGeometry, sunMaterial);
            // 将太阳添加到场景中
            scene.add(sun);

           
            // 创建地球公转的轨道
            var earthOrbit = new THREE.Object3D();
            earthOrbit.position.set(0, 0, 0);
            // earthOrbit.rotation.x = THREE.Math.degToRad(30); // 运行角度
            // 将地球公转的轨道添加到场景中
            scene.add(earthOrbit);
            // 创建地球的几何体
            var earthGeometry = new THREE.SphereGeometry(3, 32, 32);
            // 创建地球的材质
            var earthMaterial = new THREE.MeshBasicMaterial({ map: earthPicture});
            // 创建地球的网格
            var earth = new THREE.Mesh(earthGeometry, earthMaterial);
            // 将地球添加到地球公转的轨道上
            earth.position.set(20, 0, 0);
            earthOrbit.add(earth);

            // 创建地球公转轨道的几何体
            var earthOrbitGeometry = new THREE.CircleGeometry(20, 1024);
            earthOrbitGeometry.vertices.shift(); // Remove the center vertex
            earthOrbitGeometry.rotateX(Math.PI / 2); // 轨道角度
            var earthOrbitMaterial = new THREE.LineBasicMaterial({ color: 0xffffff });
            var earthOrbitLine = new THREE.LineLoop(earthOrbitGeometry, earthOrbitMaterial);
            scene.add(earthOrbitLine);



            // 创建月球的公转轨道几何体
            var moonOrbitGeometry = new THREE.CircleGeometry(4, 64);
            moonOrbitGeometry.vertices.shift(); // Remove the center vertex
            moonOrbitGeometry.rotateX(Math.PI / 2); // Rotate the geometry to align with the XY plane
            var moonOrbitMaterial = new THREE.LineBasicMaterial({ color: 0xffffff });
            var moonOrbitLine = new THREE.LineLoop(moonOrbitGeometry, moonOrbitMaterial);
            earth.add(moonOrbitLine);

            //月球公转轨道
            var moonOrbit = new THREE.Object3D();
            moonOrbit.position.set(20, 0, 0);
            earthOrbit.add(moonOrbit);
            // scene.add(moonOrbit);

            // 创建月球的几何体
            var moonGeometry = new THREE.SphereGeometry(1, 32, 32);
            // 创建月球的材质
            var moonMaterial = new THREE.MeshBasicMaterial({ map: moonPicture});
            // 创建月球的网格
            var moon = new THREE.Mesh(moonGeometry, moonMaterial);
            
            // 将月球轨道添加到地球
            moon.position.set(4, 0, 0);
            // earth.add(moon);
            moonOrbit.add(moon);


            // 设置相机的位置
            camera3D.position.z = 40;
            cameraSide.position.z = 40;
            cameraTop.position.z = 40;


            // 动画函数
            function animate() {
                // 请求动画帧
                requestAnimationFrame(animate);
                // 地球公转的轨道绕Y轴旋转
                earthOrbit.rotation.y += 0.02;
                moonOrbit.rotation.y+=0.1;
                // 地球绕Y轴旋转
                earth.rotation.y += 0.03;
                // 月球绕Y轴旋转
                moon.rotation.y += 0.1;

                sun .rotation.y+=0.02;
                // 渲染场景和相机
                // Render 3D view/3
                renderer3D.setViewport(0,0,window.innerWidth,window.innerHeight);
                renderer3D.render(scene, camera3D);
                
                rendererSide.setViewport(0,0, window.innerWidth/2, window.innerHeight/2);
                rendererSide.render(scene, cameraSide);
                // // Render top view
                rendererTop.setViewport(0,-130, window.innerWidth/2, window.innerHeight/2);
                rendererTop.render(scene, cameraTop);
            }
            // 调用动画函数
            animate();
};
    </script>
</body>
</html>
